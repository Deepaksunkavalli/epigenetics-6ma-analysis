# Epigenetics 6mA Analysis

This repository contains scripts and derived data for a small‑scale exploration of N6‑methyladenine (6mA) motifs in the *Arabidopsis thaliana* genome.

## Repository structure

- `scripts/6ma_motif_analysis.py` – Python pipeline that scans a genome FASTA for a user‑defined motif, extracts flanking windows, summarizes motif counts per chromosome, computes nucleotide frequency matrices and produces a sequence logo.
- `results/` – sample output files generated by running the pipeline on the Col‑CEN assembly using motifs GAGG and ATAT. Each run produces `<motif>_motif_positions.bed`, `<motif>_windows.fasta.gz`, `motif_counts_by_chromosome.tsv`, `motif_position_frequency.npy` and `motif_position_logo.png`.
- `docs/report.md` – research report summarizing findings from scanning the Col‑CEN assembly and integrating histone modification datasets.
- `docs/dataset_sources.md` – documentation describing where to obtain the raw genome assemblies and histone datasets.
- `requirements.txt` – dependencies required to run the analysis.
- `.gitignore` – patterns for files not tracked by git.
- `LICENSE` – open‑source license (MIT).

## Usage

Install dependencies in a virtual environment:

```sh
pip install -r requirements.txt
```

To run the motif analysis on a genome assembly:

```sh
python scripts/6ma_motif_analysis.py --fasta path/to/genome.fasta --motif MOTIF --flank 30 --outdir path/to/output_dir
```

Replace `MOTIF` with the motif of interest (e.g., `GAGG`, `ATAT`) and adjust `--flank` to set the number of bases upstream and downstream of each motif occurrence. The pipeline will scan the genome for the motif (case‑insensitive), extract windows of length `2*flank + len(MOTIF)` around each occurrence, compute nucleotide frequency matrices, generate a sequence‑logo plot and write output files to the specified directory.

For example, to search for the motif `ATAT` in the Col‑CEN assembly provided in this repository:

```sh
python scripts/6ma_motif_analysis.py --fasta Col-CEN_v1.2.fasta --motif ATAT --flank 30 --outdir results/ATAT
```

After running, the `results/ATAT` directory will contain:

- `ATAT_motif_positions.bed` – BED file listing all ATAT motif positions.
- `ATAT_windows.fasta.gz` – compressed FASTA file containing 30 bases upstream/downstream of each motif.
- `motif_counts_by_chromosome.tsv` – table summarizing motif counts per chromosome.
- `motif_position_frequency.npy` – NumPy array with nucleotide frequencies at each position.
- `motif_position_logo.png` – sequence logo built from the frequency matrix.

To reproduce the GAGG motif analysis included in this repository, run the script with `--motif GAGG` and `--outdir results/GAGG`.

## Data sources

The raw genome assemblies (TAIR10, Col‑CEN) and histone modification peak sets are not included in this repository due to their size. Please refer to `docs/dataset_sources.md` for links and instructions on obtaining these datasets.
